/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see core.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[15],{377:function(ha,ca,f){function aa(e,f,h){f.endsWith("/")||(f+="/");h=h||{};var n=h.disableWebsockets||!1;this.WU=h.singleServerMode||!1;null!=h.customQueryParameters&&Object(z.b)("wvsQueryParameters",h.customQueryParameters);f.endsWith("blackbox/")||(f+="blackbox/");this.kn=h.uploadData||null;this.Bw=h.uriData||null;this.JN=h.cacheKey||null;this.aS=h.officeLocale||null;this.ME=Object(r.a)(f,null,n);this.$f=f;this.dF=e;this.wf=
null;this.zj=y();this.bm=y();this.Ny=!1;this.lg=this.Rd=this.me=this.Ze=null;this.Cf=[];this.xz=[];this.cache={};this.timeStamp=0;this.Uf=[];this.jh=[];this.AF=null;this.VE=!1;this.VI=this.id=null;this.zH=this.EQ=fa;this.HB=0;this.DG=!1;this.z9=1;this.LA={};this.rs(!0)}function y(){var e={promise:null,resolve:null,reject:null,state:0,result:null,request:null,Cr:function(){return 1===(e.state&1)},v8:function(){return 2===(e.state&2)},Zh:function(){return!e.v8()&&!e.Cr()},b8:function(){return 4===(e.state&
4)},nU:function(){e.state|=4}};e.promise=new Promise(function(f,h){e.resolve=function(){if(0===e.state||4===e.state)e.state=1,e.result=arguments[0],f.apply(null,arguments)};e.reject=function(){if(0===e.state||4===e.state)e.state=2,h.apply(null,arguments)}});return e}function fa(){return!1}function da(e,f,h){if(!(f in ea))return!0;f=ea[f];for(var n=0;n<f.length;n++){var r=e;var w=f[n];var x=h;if(w.name in r){var y="",z=!1;r=r[w.name];switch(w.type){case "s":y="String";z=Object(ba.isString)(r);break;
case "a":y="Array";z=Object(ba.isArray)(r);break;case "n":y="Number";z=Object(ba.isNumber)(r)&&Object(ba.isFinite)(r);break;case "o":y="Object",z=Object(ba.isObject)(r)&&!Object(ba.isArray)(r)}z||x.reject('Expected response field "'+w.name+'" to have type '+y);w=z}else x.reject('Response missing field "'+w.name+'"'),w=!1;if(!w)return!1}return!0}f.r(ca);var ba=f(0);f.n(ba);var x=f(1);ha=f(45);var w=f(26),r=f(394),e=f(80),h=f(322),n=f(100),z=f(39),ja=f(142),ea={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",
type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}]};aa.prototype=Object(ba.extend)(aa.prototype,{d2:function(){var e=this;return new Promise(function(f,h){var n=new XMLHttpRequest;n.open("GET",
e.$f+"ck");n.withCredentials=e.Oo();n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?f():h())};n.send()})},Tca:function(e,f){this.EQ=e||fa;this.zH=f||fa},ZN:function(){var e=this;this.bm=y();this.zj=y();return this.ME.qF().then(function(){e.Ny=!1;e.id=null;e.VE=!1;return e.d2()})},HI:function(){this.EQ();this.VG();this.Ze&&(this.Ze.Zh()?this.xf(this.Ze.request):this.Ze.Cr()&&this.zH(this.Ze.result.url,"pdf")&&(this.Ze=null,this.KT()));this.lg&&this.lg.Zh()&&this.xf(this.lg.request);
this.me&&this.me.Zh()?this.xf(this.me.request):this.Rd&&this.Rd.Zh()&&this.tQ(this.Rd.request);var e;for(e=0;e<this.Uf.length;e++)this.Uf[e]&&this.Uf[e]&&(this.Uf[e].Zh()?this.xf(this.Uf[e].request):this.Uf[e].Cr()&&this.zH(this.Uf[e].result.url,"image")&&(this.Uf[e]=null,this.EB(e)));for(e=0;e<this.jh.length;e++)this.jh[e]&&this.jh[e]&&this.jh[e].Zh()&&!this.jh[e].b8()&&this.xf(this.jh[e].request);for(e=0;e<this.Cf.length;e++)this.Cf[e]&&this.Cf[e].Zh()&&this.xf(this.Cf[e].request)},VG:function(e){var f=
this;this.Ny||(this.timeStamp=Date.now(),this.ME.CJ(function(e){f.N9(e)},function(){return null},function(){return null},!0).then(function(){clearInterval(f.vB);f.vB=null},function(h){f.Ny=!1;if(!f.vB){var r=0;f.VE=!0;f.VI=0;f.vB=setInterval(function(){2>r++?f.HI():(clearInterval(f.vB),e&&e.reject(n.a),Object(x.f)("WebViewerServer connection failed:"+h))},5E3)}}),this.Ny=!0)},cfa:function(){var e=this,f=createPromiseCapability();if(this.kn){var h=new FormData;h.append("file",this.kn.fileHandle,this.kn.fileHandle.name);
var n=this.kn.loadCallback;var r="upload";var x=this.kn.extension}else if(this.Bw){h={uri:this.Bw.uri,Tia:this.Bw.shareId};h=Object.keys(h).map(function(e){return e+"="+(h[e]?encodeURIComponent(h[e]):"")}).join("&");var y="application/x-www-form-urlencoded; charset=UTF-8";n=this.Bw.loadCallback;r="url";x=this.Bw.extension}else return Promise.resolve();var z=new XMLHttpRequest,aa=Object(w.j)(e.$f,"AuxUpload");aa=Object(ja.a)(aa)+"&type="+r+"&ext="+x;z.open("POST",aa);z.withCredentials=this.Oo();y&&
z.setRequestHeader("Content-Type",y);z.addEventListener("load",function(){if(z.readyState===z.DONE&&200===z.status){var h=JSON.parse(z.response);e.dF=h.uri;n(h);f.resolve(h)}});z.addEventListener("error",function(){f.reject(z.statusText+" "+JSON.stringify(z))});this.kn&&null!=this.kn.onProgress&&(z.upload.onprogress=function(f){e.kn.onProgress(f)});z.send(h);return f.promise},Bba:function(e){this.password=e||null;this.zj.Cr()||(this.zj=y(),this.xf({t:"pages"}));return this.zj.promise},Vv:function(e){this.AF=
e||null;this.zj.Cr()||(this.VG(this.zj),this.xf({t:"pages"}));return this.zj.promise},aO:function(e){e=Object.assign(e,{uri:encodeURIComponent(this.dF)});this.AF&&(e.ext=this.AF);this.wf&&(e.c=this.wf);this.password&&(e.pswd=this.password);this.JN&&(e.cacheKey=this.JN);this.aS&&(e.locale=this.aS);return e},xf:function(e){e=this.aO(e);this.ME.send(e)},qk:function(e){return e},N9:function(f){var h=this,n=f.data,r=f.err,w=f.t;switch(w){case "upload":r?h.dfa.reject(r):h.dfa.resolve("Success");break;case "pages":r?
h.zj.reject(r):da(n,w,h.zj)&&h.zj.resolve(n);break;case "config":r?h.bm.reject(r):da(n,w,h.bm)&&(n.id&&(h.id=n.id),n.auth&&(f=Object(z.a)("wvsQueryParameters"),f.auth=n.auth,Object(z.b)("wvsQueryParameters",f)),n.serverVersion&&(h.zfa=n.serverVersion,Object(x.g)("[WebViewer Server] server version: "+h.zfa)),n.serverID?(h.HB=n.serverID===h.VI&&h.DG?h.HB+1:0,h.VI=n.serverID):h.HB=0,h.DG=!1,h.bm.resolve(n));break;case "health":r?h.bm.reject(r):da(n,w,h.bm)&&(n=n.unhealthy,h.WU&&n?Object(x.i)("Server failed health check. Single server mode ignoring check."):
!h.oha&&n&&1>=h.HB&&(h.DG=!0,h.ZN().then(function(){h.HI()},function(){h.HI()})));break;case "pdf":n.url=Object(ja.a)(h.$f+"../"+encodeURI(n.url));r?h.Ze.reject(r):da(n,w,h.Ze)&&h.Ze.resolve(n);break;case "docmod":n.url=Object(ja.a)(h.$f+"../"+encodeURI(n.url));r?h.LA[n.rID].reject(r):da(n,w,h.Ze)&&h.LA[n.rID].resolve(n);break;case "xod":if(r)this.me&&this.me.Zh()&&this.me.reject(r),this.Rd&&this.Rd.Zh()&&this.Rd.reject(r);else if(n.notFound)n.noCreate||this.me&&this.me.Zh()&&this.me.resolve(n),this.Rd&&
this.Rd.Zh()&&this.Rd.resolve(n);else{n.url&&(n.url=Object(ja.a)(h.$f+"../"+encodeURI(n.url)));if(!this.Rd||this.Rd.Cr())this.Rd=y(),this.Rd.request={t:"xod",noCreate:!0};this.me||(this.me=y(),this.me.request={t:"xod"});this.Rd.resolve(n);this.me.resolve(n)}break;case "annots":if(r)h.lg.reject(r);else if(da(n,w,h.lg)){h.lg.nU();var aa=new XMLHttpRequest;f=h.$f+"../"+encodeURI(n.url);var ba=n.hasAppearance?Object(ja.a)(f+".xodapp"):null;aa.open("GET",Object(ja.a)(f));aa.responseType="text";aa.withCredentials=
this.Oo();aa.addEventListener("load",function(){aa.readyState===aa.DONE&&200===aa.status&&h.lg.resolve({YJ:aa.response,tN:ba})});aa.addEventListener("error",function(){h.lg.reject(aa.statusText+" "+JSON.stringify(aa))});aa.send()}break;case "image":var ca=this.Uf[n.p];r?ca.promise.reject(r):da(n,w,ca)&&(ca.result=n,ca.result.url=Object(ja.a)(h.$f+"../"+encodeURI(ca.result.url)),ca.resolve(ca.result));break;case "tiles":ca=n.rID;f=this.Cf[ca];this.Cf[ca]=null;this.xz.push(ca);if(r)f.reject(r);else if(da(n,
w,f)){for(r=0;r<n.tiles.length;r++)n.tiles[r]=Object(ja.a)(h.$f+"../"+encodeURI(n.tiles[r]));f.resolve(n)}break;case "text":ca=this.jh[n.p];if(r)ca.reject(r);else if(da(n,w,ca)){ca.nU();var ea=new XMLHttpRequest;n=Object(ja.a)(h.$f+"../"+encodeURI(n.url));ea.open("GET",n);ea.withCredentials=this.Oo();ea.addEventListener("load",function(){ea.readyState===ea.DONE&&200===ea.status&&(ca.result=JSON.parse(ea.response),ca.resolve(ca.result))});ea.addEventListener("error",function(e){ca.reject(ea.statusText+
" "+JSON.stringify(e))});ea.send()}break;case "progress":"loading"===n.t&&h.trigger(e.a.Events.DOCUMENT_LOADING_PROGRESS,[n.bytes,n.total])}},AP:function(){this.VG(this.bm);return this.bm.promise},f5:function(){this.lg||(this.lg=y(),this.lg.request={t:"annots"},this.xf(this.lg.request));return this.lg.promise},EB:function(e){this.Uf[e]||(this.Uf[e]=y(),this.Uf[e].request={t:"image",p:e},this.xf(this.Uf[e].request));return this.Uf[e].promise},Cba:function(e){this.jh[e]||(this.jh[e]=y(),this.jh[e].request=
{t:"text",p:e},this.xf(this.jh[e].request));return this.jh[e].promise},Dba:function(e,f,h,n){var r=this.Cf.length;this.xz.length&&(r=this.xz.pop());this.Cf[r]=y();this.Cf[r].request={t:"tiles",p:e,z:f,r:h,size:n,rID:r};this.xf(this.Cf[r].request);return this.Cf[r].promise},KT:function(){this.Ze||(this.Ze=y(),this.Ze.request={t:"pdf"},this.VE?this.Ze.resolve({url:this.dF}):this.xf(this.Ze.request));return this.Ze.promise},RP:function(e){var f=this,h=new XMLHttpRequest,n=Object(ja.a)(this.$f+"aul")+
"&id="+this.id,r=new FormData,w={};e.annots&&(w.annots="xfdf");e.watermark&&(w.watermark="png");e.redactions&&(w.redactions="redact");w={t:"docmod",reqID:this.z9++,parts:w};e.print&&(w.print=!0);var x=this.aO(w);r.append("msg",JSON.stringify(x));return Promise.all([e.annots,e.watermark,e.redactions].map(function(e){return Promise.resolve(e)})).then(function(e){var w=e[0],z=e[1],aa=e[2];w&&r.append("annots",w);z&&r.append("watermark",e.watermark);aa&&r.append("redactions",aa);f.LA[x.reqID]=y();h.open("POST",
n);h.withCredentials=f.Oo;e=new Promise(function(e,f){h.onreadystatechange=function(){4===h.readyState&&(200===h.status?e():f("An error occurred while sending down annotation data to the server"))}});h.send(r);return e.then(function(){return f.LA[x.reqID].promise})})},tQ:function(){this.Rd||(this.Rd=y(),this.Rd.request={t:"xod",noCreate:!0},this.xf(this.Rd.request));return this.Rd.promise},Eba:function(){this.me||(this.me=y(),this.me.request={t:"xod"},this.xf(this.me.request));return this.me.promise},
Um:function(){return!0},request:function(){},dT:function(){},abort:function(){for(var e=0;e<this.Cf.length;e++)this.Cf[e]&&(this.Cf[e].resolve(null),this.Cf[e]=null,this.xz.push(e));this.close()},PB:function(e){this.wf=this.wf||{};this.wf.headers=e},Lha:function(){return this.wf?Object(ba.omit)(this.wf.headers,["Cookie","cookie"]):null},rs:function(e){this.wf=this.wf||{};this.wf.internal=this.wf.internal||{};this.wf.internal.withCredentials=e},Oo:function(){return this.wf&&this.wf.internal?this.wf.internal.withCredentials:
null},getFileData:function(){return Promise.reject()}});Object(ha.a)(aa);Object(h.a)(aa);Object(h.b)(aa);ca["default"]=aa},394:function(ha,ca,f){function aa(f,w,r){function e(e,f){function h(e){r().then(function(f){ca&&!ha?setTimeout(function(){h(e)},1):f.send(JSON.stringify(e))})}function n(e,f,n,r){var ea=window.createPromiseCapability(),ia=!1,ja=ea;y=e;z=f;aa=n;x=null;r&&(e=Object(da.a)("wvsQueryParameters"),e.bcid=Object(fa.k)(8),Object(da.b)("wvsQueryParameters",e));try{e=Ca?pa+"/"+Ca:pa+"/ws";
e=Object(ba.a)(e);var la=new WebSocket(e);la.onopen=function(){ea.resolve();ia=!0;ea=null;ca=!1;w.resolve(la);z&&z()};la.onerror=function(e){ca=ha=!0;ea&&ea.reject(e);x&&x.reject()};la.onclose=function(){w=window.createPromiseCapability();ca=!0;x||(x=window.createPromiseCapability());x.resolve();aa&&aa();y&&ia&&y({t:"health",data:{unhealthy:!0,isDead:!0}})};la.onmessage=function(e){e&&e.data&&(e=JSON.parse(e.data),e.hb?h({hb:!0}):e.end?close():y(e))}}catch(ua){ea.reject(ua),ea=null}return ja.promise}
function r(){ca&&y&&n(y);return w.promise}var w=window.createPromiseCapability(),x=null,y,z,aa=null,ca=!1,ha=!1,Ca=f,pa=function(e){var f=e.indexOf("://"),h="ws://";0>f?f=0:(5===f&&(h="wss://"),f+=3);var n=e.lastIndexOf("/");0>n&&(n=e.length);return h+e.slice(f,n)}(e);return{send:h,CJ:n,qF:function(){return x?x.promise:r().then(function(e){x=window.createPromiseCapability();y=null;e.close();return x.promise})}}}function h(e){var f=e.lastIndexOf("/");0>f&&(f=e.length);return e.slice(0,f)}return window.WebSocket&&
!r?e(f,w):function(e,f){function n(e){(ca?ca.promise:Promise.resolve(da)).then(function(f){var h=new XMLHttpRequest,n=aa?z+"/"+aa+"pf":z+"/pf";n=Object(ba.a)(n)+"&id="+f;f=new FormData;f.append("data",JSON.stringify(e));h.open("POST",n);h.withCredentials=!0;h.send(f)})}function r(){da=0;ca||(ca=window.createPromiseCapability())}function w(){x=new XMLHttpRequest;var e=z+"/pf";e+=0!==da?"?id="+da+"&uc="+pa:"?uc="+pa;pa++;x.open("GET",e,!0);x.withCredentials=!0;x.setRequestHeader("Cache-Control","no-cache");
x.setRequestHeader("X-Requested-With","XMLHttpRequest");var f=x,h=!1;x.onreadystatechange=function(){a:if(3<=f.readyState&&!h){try{var e=f.responseText.length}catch(Da){Object(y.g)("caught exception");break a}if(0<e)try{var x=f.responseText.split("\n");for(x[x.length-1]&&x.pop();0<x.length&&3>x[x.length-1].length;)"]"===x.pop()&&r();0<x.length&&3>x[0].length&&x.shift();for(e=0;e<x.length;++e)x[e].endsWith(",")&&(x[e]=x[e].substr(0,x[e].length-1));0===da&&0<x.length&&(da=JSON.parse(x.shift()).id,e=
ca,ca=null,e.resolve(da));var z;for(e=0;e<x.length;++e)(z=JSON.parse(x[e]))&&z.end?close():z&&z.hb&&z.id===da?n({hb:!0}):Ca(z)}catch(Da){}fa||(h=!0,w())}};x.send()}var x,z=h(e),aa=f,da=0,ca=window.createPromiseCapability(),fa=!1,ha=null,Ca=null,pa=0;return{send:n,CJ:function(e,f,h){Ca=e;ha=h;fa=!1;r();w();f&&f();return Promise.resolve()},qF:function(){r();Ca=null;fa=!0;ha&&ha();x.abort();return Promise.resolve()}}}(f,w)}f.d(ca,"a",function(){return aa});var y=f(1),fa=f(26),da=f(39),ba=f(142)}}]);}).call(this || window)
